# BuptRoom-back-end

安卓开发基础大作业-后端部分

> 前端部分请见 [Android-devlopment](https://github.com/FAWC-bupt/Android-devlopment)

利用我自己的学号密码通过`selenium`获得登录教务的 Cookie，然后用`BeautifulSoup`等爬取解析空教室数据。

后端 Web 框架是 `Flask`，在 5438 端口上特定的 Http Post 请求将返回 Json 格式数据，Post 请求的负载（Payload）中**id** 和 **password** 是必须的，作用是验证前端设备，具体详见`net.py`。（我在运行过程中发现经常会有不明来历的 IP 发送请求，真可怕）鉴于`selenium`令人捉急的内存占用和运行速度，加之没有人会每时每刻都在借教室，本程序设定了每 30 分钟爬取一次并存储到内存缓存中（没有数据持久化），该功能调用了 WinAPI，因此似乎只有 WindowsServer 能用。如果需要使用本人服务器获取数据，可以通过邮箱 kevin_lgh@foxmail.com 联系我。

返回的 Json 数据结构可以这样理解：
它是一个三维数组 **data[n][7][14]**，第一个维度是各个教室（字符串），第二个维度是每周七天，第三个维度是每天的 14 节课。元素内容只有 0 和 1，0 代表教室忙，1 代表教室空，数据示例如下（已经经过初步处理）:

```
key: 3-211(100/50)
星期1:[0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0]|星期2:[0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0]|星期3:[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]|星期4:[0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1]|星期5:[0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0]|星期6:[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]|星期7:[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]|

```
